# type: "map"

`map` 用于创建一个地图，目前只是简单地支持在地图上显示位置：

```js
{
  type: "map",
  props: {
    location: {
      lat: 31.2990,
      lng: 120.5853
    }
  },
  layout: $layout.fill
}
```

在地图上显示苏州。

# props

属性 | 类型 | 读写 | 说明
---|---|---|---
location | object | 只写 | 用户位置

在后续的更新中将会添加更多细节，例如导航。

---

## 文件内容解读与示例

### 组件用途与版本说明

`map` 组件用于在界面中嵌入一个可交互的地图视图。你可以用它来展示地理位置、标记地点、或显示用户当前位置。

**重要提示**：当前这份文档描述的是一个非常早期的 `map` 组件，其功能非常有限。现代 JSBox 中的 `map` 组件已经获得了巨大的功能增强，变得更加实用和强大。下面的解读将涵盖这些现代化的核心功能。

### 现代 Map 组件的核心功能

#### 1. `region` (显示区域) - 控制视野

这是现代地图组件控制显示范围的核心属性，它比简单的 `location` 更强大，因为它不仅能定义中心点，还能定义**缩放级别**。

```javascript
region: {
  lat: 31.2304, // 纬度
  lng: 121.4737, // 经度
  lat_span: 0.5, // 纬度范围，数值越小，地图越放大
  lng_span: 0.5  // 经度范围，数值越小，地图越放大
}
```

#### 2. `annotations` (地图标注) - 添加大头针

这是地图最重要的功能之一。通过 `annotations` 属性，你可以在地图上放置一个或多个“大头针”来标记具体地点。它是一个数组，每个元素都是一个标注对象。

```javascript
annotations: [
  {
    lat: 31.2402, // 标注的纬度
    lng: 121.4879, // 标注的经度
    title: "上海外滩", // 主标题
    subtitle: "万国建筑博览群" // 副标题（可选）
  }
]
```

#### 3. `showsUserLocation` (显示用户位置)

一个简单的布尔值属性，设置为 `true` 后，地图上会显示一个代表用户当前位置的蓝色圆点。

```javascript
props: {
  showsUserLocation: true
}
```

#### 4. 交互事件 `didSelect`

当用户点击一个你添加的地图标注（大头针）时，`didSelect` 事件会被触发，并返回该标注的数据。

### 示例代码：标记城市中的一个地点

下面的示例将创建一个地图，将其中心设置为上海市，并在此地图上添加一个“外滩”的大头针标记，同时响应用户的点击事件。

```javascript
$ui.render({
  props: {
    title: "Map 组件示例"
  },
  views: [
    {
      type: "map",
      props: {
        // 1. 设置地图的显示区域和缩放级别
        region: {
          lat: 31.2304, // 上海市中心纬度
          lng: 121.4737, // 上海市中心经度
          lat_span: 0.2,  // 较小的 span 值意味着更放大的地图
          lng_span: 0.2
        },
        // 2. 在地图上显示用户位置的蓝点
        showsUserLocation: true,
        // 3. 添加一个或多个大头针
        annotations: [
          {
            lat: 31.2402,
            lng: 121.4879,
            title: "上海外滩"
          }
        ]
      },
      layout: $layout.fill,
      events: {
        // 4. 处理大头针的点击事件
        didSelect: function(sender, annotation) {
          $ui.alert(`你点击了：${annotation.title}`);
        }
      }
    }
  ]
});
```

**代码解读**：

1.  我们使用 `region` 属性来精确地控制地图的初始视野，让它聚焦于上海市中心，并设置了一个合适的缩放级别。
2.  `showsUserLocation: true` 会请求定位权限（如果需要），并在地图上显示用户位置。
3.  `annotations` 数组中我们只放了一个对象，于是在外滩的位置上出现了一个大头针。
4.  `didSelect` 事件让我们能够响应用户对大头针的点击，并通过 `annotation` 参数获取到被点击的那个大头针的所有数据（纬度、经度、标题等）。

尽管本文档的原始部分很简单，但现代的 `map` 组件已经是一个功能完备的工具。掌握 `region` 和 `annotations` 是使用它的关键。 
