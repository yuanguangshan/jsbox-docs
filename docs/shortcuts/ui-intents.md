# 显示 JSBox 界面

你可以在 Siri 界面显示由 JSBox 脚本编写的界面，这种形式无需通过 `$intents.finish()` 结束运行，更确切地说这种模式运行的脚本，就是普通的带界面的 JSBox 脚本，你只需要在脚本设置里面将其添加到 Siri 或捷径应用即可。

例如：

```js
$ui.render({
  views: [
    {
      type: "label",
      props: {
        text: "Hey, Siri!"
      },
      layout: function(make, view) {
        make.center.equalTo(view.super);
      }
    }
  ]
});
```

这个代码可以在 Siri 界面显示一个文字：`Hey, Siri!`。

# 设置参数

在 iOS 13 的捷径应用上，你可以为 JSBox 的捷径模块指定两个参数：`脚本名`和`输入参数`。

输入参数在捷径应用中显示类型为字符串类型，但请填写一个捷径中的字典类型，JSBox 在获取到之后会解析成一个 JSON 数据，你可以通过 `$context.query` 获取：

```js
const query = $context.query;
```

---

## 文件内容解读与示例

### 用途说明

本文档介绍了如何在 Siri 或“快捷指令”应用中**直接显示一个由 JSBox 脚本构建的用户界面（UI）**。这与在后台运行脚本并返回结果不同，它提供了一种在自动化流程中进行**可视化交互**的强大方式。

### 核心概念：运行带界面的脚本

-   **运行模式**: 当你选择在快捷指令中显示 JSBox 界面时，其运行模式与在 JSBox 应用内直接运行一个带UI的脚本（使用 `$ui.render`）是完全相同的。
-   **无需 `$intents.finish()`**: 因为脚本的目的是显示一个界面并与之交互，而不是计算一个结果并返回，所以**不需要**调用 `$intents.finish()` 来结束脚本。脚本的生命周期由其 UI 控制，当 UI 关闭时，脚本自然结束。
-   **设置方式**: 要想让一个脚本能在快捷指令中显示界面，你需要在该脚本的设置页面，通过“添加到 Siri”或类似的选项，将其注册为快捷指令动作。

### 如何传递参数 (`$context.query`)

从 iOS 13 开始，快捷指令为 JSBox 动作提供了更强的能力，允许你传递**输入参数**。

-   **参数设置**: 在“快捷指令”应用中，配置“运行 JSBox 脚本”动作时，你会看到“脚本名”和“输入参数”两个字段。
-   **数据格式**: “输入参数”字段虽然在快捷指令中显示为字符串类型，但你应该在这里传入一个**快捷指令字典（Dictionary）**。你可以使用快捷指令的“字典”动作来构建这个参数。
-   **在 JSBox 中获取**: 当快捷指令运行时，JSBox 会自动将传入的字典解析成一个 JSON 对象。你可以通过全局变量 `$context.query` 来获取这个对象。

### 示例：显示带有动态文本的界面

这个例子将演示如何创建一个快捷指令，它会提示用户输入一段文本，然后让 JSBox 在 Siri 界面上显示这段文本。

**1. JSBox 脚本 (`Show Text UI.js`)**

```javascript
// Show Text UI.js

// 从快捷指令的输入参数中获取要显示的文本
const textToShow = $context.query.text || "默认文本";

// 渲染一个界面
$ui.render({
  props: {
    title: "Siri 界面"
  },
  views: [
    {
      type: "label",
      props: {
        text: textToShow,
        align: $align.center,
        font: $font("bold", 24)
      },
      layout: function(make, view) {
        make.center.equalTo(view.super);
      }
    }
  ]
});
```

**2. 在“快捷指令”应用中创建快捷指令**

-   打开“快捷指令”应用，创建新快捷指令。
-   添加一个“要求输入”动作，提示设为“请输入要显示的文本”。
-   添加一个“字典”动作。设置一个键，名为 `text`，值设为上一步“要求输入”的结果。
-   添加 JSBox 的“运行 JSBox 脚本”动作。
    -   **脚本**: 选择 `Show Text UI.js`。
    -   **输入参数**: 选择上一步创建的“字典”。

**预期结果**

运行此快捷指令，它会先弹出一个输入框。输入“你好，Siri”后，Siri 界面会滑出，并显示一个由 JSBox 渲染的视图，上面有“你好，Siri”的标签。

### 总结

通过直接在 Siri 和快捷指令中显示 UI，JSBox 脚本可以将简单的自动化流程转变为功能丰富的交互式应用。结合参数传递功能，你可以创建出高度动态和个性化的快捷指令，例如展示动态数据、提供复杂选项等。