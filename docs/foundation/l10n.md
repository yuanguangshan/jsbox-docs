> 让你的程序支持多种语言环境，将会有利于使用以及传播，这是一个好的观念和习惯。

# $l10n

扩展在显示文字的时候支持多种语言，JSBox 提供了简单的本地化支持，`l10n` 是 `Localization` 的缩写，因为刚好有 10 个字母。

当然，你也可以通过 `$device.info` 获取当前设备的语言，进而手动提供多种语言，`$l10n` 是一个简单的封装，让代码可以更简单。

# $app.strings

本地化工作有两个步骤：

- 通过 `$app.strings` 定义要用到的文本
- 通过 `$l10n` 获取本地化过的文本

示例：

```js
$app.strings = {
  "en": {
    "title": "tortoise"
  },
  "zh-Hans": {
    "title": "乌龟"
  },
  "zh-Hant": {
    "title": "烏龜"
  }
}
```

其中 `en` 表示英文，`zh-Hans` 表示简体中文，`zh-Hant` 表示繁体中文。

当我们使用时，通过 `$l10n` 取出：

```js
const title = $l10n("title");
```

请注意，当用户设备没能找到合适的字符串时，将会有如下回退策略：

- 没有找到对应语言，回退到英语版本
- 没有找到对于的 value，回退到 key 本身

---

## 文件内容解读与示例

### 用途说明

`$l10n` API（`l10n` 是 `localization` 的缩写，意为“本地化”）提供了一种简单而有效的方式，让你的 JSBox 脚本能够**支持多语言**。这意味着你的脚本可以根据用户设备的语言设置，自动显示不同语言的文本内容，从而极大地提升用户体验和脚本的普适性。

### 核心概念：两步走本地化

JSBox 的本地化机制非常直观，主要分为两个步骤：

1.  **定义多语言字符串 (`$app.strings`)**: 
    -   你需要在一个全局对象 `$app.strings` 中，以**语言代码**（如 `"en"` 代表英文，`"zh-Hans"` 代表简体中文，`"zh-Hant"` 代表繁体中文）为键，定义所有需要本地化的文本内容。
    -   每个语言代码对应一个对象，该对象中包含了键值对，键是你的文本标识符，值是该语言下的实际文本。

2.  **获取本地化文本 (`$l10n(key)`)**: 
    -   在你的脚本代码中，当你需要显示文本时，不再直接使用硬编码的字符串，而是调用 `$l10n(key)` 函数。
    -   `$l10n` 会自动检测当前设备的语言设置，并从 `$app.strings` 中找到对应的语言文本返回。

#### 回退策略

当 `$l10n` 无法找到与当前设备语言完全匹配的文本时，它会遵循以下回退策略，以确保脚本始终能显示一些内容：

1.  **回退到英文**: 如果找不到当前设备语言的翻译，它会尝试查找 `"en"`（英文）版本。
2.  **回退到键本身**: 如果连英文版本也找不到，它会直接返回你传入的 `key` 字符串。这有助于开发者发现哪些文本没有被翻译。

### 示例代码：一个多语言问候应用

下面的示例将创建一个简单的应用，根据设备语言显示不同的问候语和按钮文本。

```javascript
// 1. 定义多语言字符串
$app.strings = {
  "en": {
    "greeting": "Hello, JSBox!",
    "button_text": "Say Hello"
  },
  "zh-Hans": {
    "greeting": "你好，JSBox！",
    "button_text": "说你好"
  },
  "ja": {
    "greeting": "こんにちは、JSBox！",
    "button_text": "こんにちは"
  }
};

$ui.render({
  props: {
    title: $l10n("greeting") // 标题也进行本地化
  },
  views: [
    {
      type: "label",
      props: {
        text: $l10n("greeting"), // 使用 $l10n 获取问候语
        font: $font("bold", 24),
        align: $align.center
      },
      layout: make => {
        make.center.equalTo(view.super);
      }
    },
    {
      type: "button",
      props: {
        title: $l10n("button_text") // 使用 $l10n 获取按钮文本
      },
      layout: make => {
        make.top.equalTo(view.prev.bottom).offset(20);
        make.centerX.equalTo(view.super);
        make.width.equalTo(150);
      },
      events: {
        tapped: () => {
          $ui.alert($l10n("greeting"));
        }
      }
    }
  ]
});
```

**代码解读**：

1.  我们在脚本开头定义了 `$app.strings` 对象，包含了英文、简体中文和日文的翻译。`greeting` 和 `button_text` 是我们定义的文本标识符。
2.  在 `render` 函数中，所有需要显示文本的地方（`title`、`label` 的 `text`、`button` 的 `title`）都使用了 `$l10n("key")` 的形式。
3.  当你运行这个脚本时，JSBox 会根据你设备的语言设置，自动选择对应的翻译。例如，如果你的设备语言是简体中文，你将看到“你好，JSBox！”和“说你好”；如果是英文，则会看到“Hello, JSBox!”和“Say Hello”。

通过 `$l10n`，你可以轻松地让你的 JSBox 脚本走向国际化，为不同语言的用户提供更好的体验。 
